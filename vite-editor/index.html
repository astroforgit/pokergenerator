<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Atari Strip Poker Image Editor</title>
  </head>
  <body>
    <header>
      <div style="display:flex; align-items:center">
          <h1>Atari Image Editor</h1>
          <span id="status" class="status">Loading embedded ATR...</span>
      </div>
      <div>
          <button id="loadAtrBtn" title="Load a different ATR file">üìÅ Load Different ATR</button>
          <button id="saveAtrBtn" class="primary">üíæ Download Modified ATR</button>
          <input type="file" id="atrInput" accept=".atr" style="display:none">
      </div>
    </header>

    <div class="main-container">
        <div class="sidebar">
            <ul id="fileList" class="file-list">
                <!-- Files will go here -->
            </ul>
        </div>
        <div class="editor-area">
            <div id="editorControls" style="display:none; flex-direction: column; align-items: center;">
                <!-- Canvas Area -->
                <div class="canvas-wrapper">
                    <div class="canvas-container">
                        <canvas id="editorCanvas" width="160" height="140"></canvas>
                        <div id="cropOverlay" style="display:none;"></div>
                    </div>
                    <p style="font-size: 0.75rem; color: #888; margin: 5px 0;">
                        Display scaled to match Atari aspect ratio (pixels are rectangular, not square)
                    </p>
                </div>

                <!-- Image Import Section -->
                <div id="importSection" class="tool-section" style="display:none;">
                    <h3>Import Image</h3>
                    <canvas id="importCanvas" width="160" height="140" style="border: 1px solid #555; max-width: 400px;"></canvas>
                    <div class="toolbar">
                        <button id="cropBtn">Crop to 160√ó140</button>
                        <button id="resizeFitBtn">Resize (Fit)</button>
                        <button id="resizeFillBtn">Resize (Fill)</button>
                        <button id="applyImportBtn" class="primary">Apply to Canvas</button>
                        <button id="cancelImportBtn">Cancel</button>
                    </div>
                    <p style="font-size: 0.75rem; color: #888; margin: 5px 0;">
                        Image will be auto-converted to 4-color Atari palette
                    </p>
                </div>

                <!-- Drawing Tools -->
                <div class="palette">
                    <div class="swatch selected" data-color="0" style="background-color: rgb(0,0,0)" title="Color 0 (Black)"></div>
                    <div class="swatch" data-color="1" style="background-color: rgb(148,108,0)" title="Color 1 (Dark Brown)"></div>
                    <div class="swatch" data-color="2" style="background-color: rgb(228,188,124)" title="Color 2 (Light Tan)"></div>
                    <div class="swatch" data-color="3" style="background-color: rgb(255,228,184)" title="Color 3 (Light Orange)"></div>
                </div>

                <div class="toolbar">
                    <button id="importPngBtn">üìÅ Import PNG</button>
                    <input type="file" id="pngInput" accept="image/*" style="display:none">
                    <button id="exportPngBtn">üì§ Export as PNG</button>
                    <button id="clearBtn">üóëÔ∏è Clear</button>
                    <button id="commitBtn" class="primary">üíæ Update File in Disk</button>
                </div>
                <p style="font-size: 0.8rem; color: #888; max-width: 600px; text-align: center; margin-top: 10px;">
                    "Update File in Disk" modifies the memory buffer. Click "Download Modified ATR" to save the final file to your computer.
                </p>
            </div>
            <div id="placeholder" style="margin-top: 100px; color: #666;">
                Select a file from the list to edit.
            </div>
        </div>
    </div>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
